---
import { getEntry } from 'astro:content';

const exhibitionsEntry = await getEntry('exhibitions', 'list');
const rawItems = exhibitionsEntry ? exhibitionsEntry.data.items : [];

const exhibitionsByYear = rawItems.reduce((acc: Record<string, typeof rawItems>, item) => {
    const year = item.year;
    if (!acc[year]) { acc[year] = []; }
    acc[year].push(item);
    return acc;
}, {});

const sortedYears = Object.keys(exhibitionsByYear).sort((a, b) => Number(b) - Number(a));
---

<section class="max-w-4xl mx-auto px-4 py-16 text-center">
    
    <h3 class="text-3xl md:text-4xl font-serif-title uppercase tracking-widest mb-16 text-text-main transition-colors">
        Mostre e Riconoscimenti
    </h3>

    <div class="space-y-16">
        
        {sortedYears.map((year) => (
            <div class="relative">
                
                <h4 class="text-2xl font-serif-title text-text-main mb-6 inline-block px-8 transition-colors">
                    {year}
                </h4>

                <div class="space-y-3">
                    {exhibitionsByYear[year].map((item) => (
                        <div class="text-sm md:text-base text-text-muted font-sans font-light tracking-wide uppercase transition-colors">
                            {item.description}
                        </div>
                    ))}
                </div>

            </div>
        ))}

    </div>
</section>